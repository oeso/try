<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>페이징 구현 TEST</title>
    <script src="https://code.jquery.com/jquery-3.1.0.min.js"></script>
    <style>h1{text-align:center;margin:30px 0;}#paging{margin:20px 0 40px;text-align:center}strong,a{border-radius:4px;color:#666;display:inline-block;min-width:25px;font-weight:normal; margin:0 3px;text-decoration:none; font-size:15px;font-family:"Dotum", sans-serif}
        table,tr,td,th {border:1px solid #666;border-collapse:collapse}a,strong{padding:10px;background:#eee}.current {color:crimson;font-weight:bold}
    </style>
</head>
<body>
    <h1>Paging</h1>
    <div id="paging">
        <a href="" class="first">처음</a>
        <a href="" class="prev">이전</a>
        <a class="current">0</a>
        <a href="" class="next">다음</a>
        <a href="" class="last">마지막</a>
    </div>
    <table style="width:900px;margin:20px auto">
        <thead>
            <tr><th>TITLE</th><th>TITLE</th><th>TITLE</th><th>TITLE</th></tr>
        </thead>
        <tbody>
            <tr><td>number</td><td>content</td><td>content</td><td>content</td></tr>
            <tr><td>number</td><td>content</td><td>content</td><td>content</td></tr>
            <tr><td>number</td><td>content</td><td>content</td><td>content</td></tr>
            <tr><td>number</td><td>content</td><td>content</td><td>content</td></tr>
            <tr><td>number</td><td>content</td><td>content</td><td>content</td></tr>
        </tbody>
    </table>
    <script>
        function ottoriPagination(){
            this.paging = function(obj){
                var pageBox = $("#"+obj.id)
                var row = obj.row
                    ,pageGroup = obj.pageGroup
                    ,page = obj.page
                    ,that = this;

                that.pageList = new Array();
                this.arr = new Array();

                //현재 페이지리스트로 뿌려줄 시작넘버와 마지막넘버 구하기.
                var pageStart = (page / pageGroup) <= 1 ? 1 : Math.floor(page / pageGroup)*pageGroup+1;
                var pageEnd =  (pageStart > pageGroup) ? pageStart+(pageGroup-1) : pageGroup;
                var pageContent = new Array();

               function pageContents(){
                   for(var i=pageStart; i<=pageEnd; i++){
                        if(i == page){
                            pageContent.push("<strong class='current'>"+ i +"</strong>");
                        }else{
                            pageContent.push("<a href='#'>"+ i +"</a>");
                        };
                    };
                    pageContent = pageContent.join("");
                };
                pageContents();

                that.pageList.push("<a href='#' class='first'>처음</a>");
                that.pageList.push("<a href='#' class='prev'>이전</a>");
                that.pageList.push(pageContent);
                that.pageList.push("<a href='#' class='next'>다음</a>");
                that.pageList.push("<a href='#' class='last'>끝</a>");

                pageBox.html(that.pageList);

                //클릭시 해당 링크 볼드 표시
                $("#paging a").click(function(e){
                    var links = $(this);
                    if(links.hasClass("first")){
                        changePage();
                    }else if(links.hasClass("prev")){
                        console.log("prev")
                        pageContent = new Array();
                        pageStart = pageStart - pageGroup;
                        pageEnd = pageEnd - pageGroup;

                        // $.ajax("https://oeso.github.io/try/paging/json/dataurl.json", function(data){
                        //     console.log(data)
                        //     .done(function() {
                        //         console.log( "second success" );
                        //     })
                        //     .fail(function() {
                        //         console.log( "error" );
                        //     })
                        //     .always(function() {
                        //         console.log( "complete" );
                        //     });
                        // })
                        $.ajax({
                            url: "https://oeso.github.io/try/paging/json/dataurl.json",
                            context: document.body
                            }).done(function(data) {
                            alert( data.first.value );
                        });
                        //changePage(page)
                        //pageContents();

                        $(".prev").after(pageContent);
                    }else if(links.hasClass("next")){
                        changePage();
                    }else if(links.hasClass("last")){
                        changePage();
                    }else{
                        $("#paging a, #paging strong").removeClass("current");
                        links.addClass("current");
                    }
                    e.preventDefault();
                });

                // function changePage(page, url){
                //     $.ajax("https://oeso.github.io/try/paging/json/dataurl.json", function(data){


                //             console.log(data)


                //     })
                // }
            }
        };
        var Opage = new ottoriPagination();
        Opage.paging({
            id : "paging",
            page : 11,
            row : 5,
            totalCount : 2000,
            pageGroup : 10
        });
    </script>

</body>
</html>

